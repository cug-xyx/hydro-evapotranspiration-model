??hydroET
T|T
T|F
T & T
T & F
errorCondition('1')
errorCondition('1231231')
error(1)
warning('1')
warningCondition('1')
stop(1)
devtools::load_all(".")
devtools::load_all(".")
cal_VPD(20)
cal_VPD(20, ea = 1)
cal_VPD(20, ea = 2)
cal_VPD(20, ea = 2, Pa = 101)
cal_VPD(20, ea = 2, Pa = 101.325)
cal_VPD(20, Td = 15)
cal_VPD(20, q = 0.7)
cal_VPD(20, q = 0.1)
cal_VPD(20, q = 0.002)
devtools::document()
devtools::check()
ï¼Ÿuniroot
?uniroot
1e-7
print(1e-7)
1e-1
devtools::document()
devtools::check()
devtools::load_all(".")
cal_Tws(Ta = 20, 50, 3, 0.5)
library(data.table)
library(tidyverse)
d <- fread('inst/extdata/raw/50136.csv')
d %<>%
mutate(VPD = cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d
d %>% summary()
d
d %>% .$ET_CR %>% plot()
d %>%
filter(ET_CR <= 20)
d %>%
filter(ET_CR <= 20) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_line()
d %>%
filter(-20 <= ET_CR <= 20) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_line()
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_line()
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
group_by(year = year(ET_CR)) %>%
summarise(ET_yearly = sum(ET_CR))
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
group_by(year = year(ET_CR))
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
group_by(year = year(date)) %>%
summarise(ET_yearly = sum(ET_CR))
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
group_by(year = year(date)) %>%
summarise(ET_yearly = sum(ET_CR)) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_line()
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
group_by(year = year(date)) %>%
summarise(ET_yearly = sum(ET_CR)) %>%
ggplot(aes(x = date, y = ET_yearly)) +
geom_line()
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
group_by(year = year(date)) %>%
summarise(ET_yearly = sum(ET_CR)) %>%
ggplot(aes(x = year, y = ET_yearly)) +
geom_line()
d %>% summary()
d %>% which(ET_CR >= 10)
which(d$ET_CR >= 10)
which(d$ET_CR >= 20)
which(d$ET_CR >= 20 & d$ET_CR <= -20)
which(d$ET_CR >= 20 | d$ET_CR <= -20)
which(d$ET_CR >= 20 | d$ET_CR <= 0)
which(d$ET_CR >= 20 | d$ET_CR <= -20)
which(d$ET_CR >= 20 | d$ET_CR <= -5)
which(d$ET_CR >= 20 | d$ET_CR <= -1)
which(d$ET_CR >= 30 | d$ET_CR <= -1)
which(d$ET_CR >= 40 | d$ET_CR <= -1)
which(d$ET_CR >= 50 | d$ET_CR <= -1)
which(d$ET_CR >= 60 | d$ET_CR <= -1)
which(d$ET_CR >= 70 | d$ET_CR <= -1)
d %<>%
mutate(VPD = cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
group_by(year = year(date)) %>%
summarise(ET_yearly = sum(ET_CR)) %>%
ggplot(aes(x = year, y = ET_yearly)) +
geom_line()
d %>%
filter(ET_CR <= 20, ET_CR >= -20)
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
select(date, ET_CR, ET_PM)
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
select(date, ET_CR, ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET')
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
select(date, ET_CR, ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET))
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
select(date, ET_CR, ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
select(date, ET_CR, ET_Penman = ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>%
filter(ET_CR <= 20, ET_CR >= -20) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>%
filter(ET_CR <= 50, ET_CR >= -1) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>%
filter(ET_CR <= 30, ET_CR >= -1) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>%
filter(ET_CR <= 20, ET_CR >= -1) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>%
filter(ET_CR <= 20, ET_CR >= -1) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM) %>% summary()
d %>% summary()
d %>%
filter(ET_CR >= -5, ET_CR <= 100)
d %>%
filter(ET_CR >= -5, ET_CR <= 100) %>% summary()
d %>%
filter(ET_CR >= -5, ET_CR <= 200) %>% summary()
d %>%
filter(ET_CR >= -5, ET_CR <= 50) %>% summary()
d %>%
filter(ET_CR <= 20, ET_CR >= 0) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM) %>% summary()
d %>%
filter(ET_CR <= 20, ET_CR >= 0) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
devtools::load_all(".")
cal_Tdry
cal_Twb
cal_Twb(VPD = 0.5, Ta = 20, Pa = 101)
cal_Twb(VPD = 0.5, Ta = 20, Pa = 101)
cal_Twb(VPD = 0.5, Ta = 20, Pa = 102)
library(data.table)
library(tidyverse)
d <- fread('inst/extdata/raw/50136.csv')
# function:
# beta_p = gma * (Tws - Ta) / (cal_es(Tws) - ea)
# beta_p * cal_es(Tws) = beta_p * ea + gma * Tws - gma * Ta
# beta_p * cal_es(Tws) - gma * Tws = beta_p * ea - gma * Ta
d
devtools::load_all('../../hydroTools/')
d %<>%
mutate(VPD = cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa),
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d %<>%
mutate(VPD = cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa),
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
# function:
# beta_p = gma * (Tws - Ta) / (cal_es(Tws) - ea)
# beta_p * cal_es(Tws) = beta_p * ea + gma * Tws - gma * Ta
# beta_p * cal_es(Tws) - gma * Tws = beta_p * ea - gma * Ta
cal_VPD
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa),
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d %>% summary()
ET_CR_Ma2021
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d %>% summary()
d %>%
filter(ET_CR >= -5, ET_CR <= 50) %>% summary()
d %>%
filter(ET_CR <= 20, ET_CR >= 0) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM, ET_CR_hydroTools) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>%
filter(ET_CR <= 15, ET_CR >= 0) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM, ET_CR_hydroTools) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>%
filter(ET_CR <= 20, ET_CR >= 0,
ET_CR_hydroTools <= 20, ET_CR_hydroTools >= 0) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM, ET_CR_hydroTools) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
ET_PT1972
min(1, 2)
min(1, 5)
devtools::load_all(".")
ET_CR_Ma
d <- fread('inst/extdata/raw/50136.csv')
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa),
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
min(c(1, 2), c(2, 1))
matrix(1:4, ncol = 2)
matrix(1:4, ncol = 2)[, 3] = 1
devtools::load_all(".")
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa),
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d <- fread('inst/extdata/raw/50136.csv')
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa),
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d %>% summary()
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d <- fread('inst/extdata/raw/50136.csv')
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d %>% summary()
devtools::load_all(".")
d <- fread('inst/extdata/raw/50136.csv')
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d %>% summary()
3^3
3**3
devtools::load_all(".")
d <- fread('inst/extdata/raw/50136.csv')
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_Ma_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d %>% summary()
devtools::load_all(".")
d <- fread('inst/extdata/raw/50136.csv')
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_Ma_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d %>% summary()
devtools::load_all(".")
d <- fread('inst/extdata/raw/50136.csv')
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_Ma_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
d %>% summary()
d %>% select(ET_CR_Ma, ET_CR_Ma_hydroTools, ET_CR_Xiao, ET_PM)
d %>% select(date, ET_CR_Ma, ET_CR_Ma_hydroTools, ET_CR_Xiao, ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET))
d %>% select(date, ET_CR_Ma, ET_CR_Ma_hydroTools, ET_CR_Xiao, ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET, color = 'type')) +
geom_line()
d %>% select(date, ET_CR_Ma, ET_CR_Ma_hydroTools, ET_CR_Xiao, ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = 'type')) +
geom_line()
d %>% select(date, ET_CR_Ma, ET_CR_Ma_hydroTools, ET_CR_Xiao, ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>% select(date, ET_CR_Ma,
# ET_CR_Ma_hydroTools,
ET_CR_Xiao, ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
devtools::load_all(".")
d <- fread('inst/extdata/raw/50136.csv')
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma_old = ET_CR_Ma_old(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_Ma_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
# debug 2022-06-30
d %>%
filter(ET_CR <= 20, ET_CR >= 0,
ET_CR_hydroTools <= 20, ET_CR_hydroTools >= 0) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM, ET_CR_hydroTools) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
# debug 2022-06-30
d %>%
filter(ET_CR_Ma_old <= 20, ET_CR_Ma_old >= 0,
ET_CR_hydroTools <= 20, ET_CR_hydroTools >= 0) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM, ET_CR_hydroTools) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
# debug 2022-06-30
d %>%
filter(ET_CR_Ma_old <= 20, ET_CR_Ma_old >= 0,
ET_CR_Ma_hydroTools <= 20, ET_CR_Ma_hydroTools >= 0) %>%
select(date, ET_CR_Ma = ET_CR, ET_Penman1948 = ET_PM, ET_CR_hydroTools) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
# debug 2022-06-30
d %>%
filter(ET_CR_Ma_old <= 20, ET_CR_Ma_old >= 0,
ET_CR_Ma_hydroTools <= 20, ET_CR_Ma_hydroTools >= 0) %>%
select(date, ET_CR_Ma, ET_CR_Ma_old, ET_Penman1948 = ET_PM,
ET_CR_Ma_hydroTools, ET_CR_Xiao) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d <- fread('inst/extdata/raw/54511.csv')
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma_old = ET_CR_Ma_old(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_Ma_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
# debug 2022-07-02
d %>%
filter(ET_CR_Ma_old <= 20, ET_CR_Ma_old >= 0,
ET_CR_Ma_hydroTools <= 20, ET_CR_Ma_hydroTools >= 0) %>%
select(date, ET_CR_Ma, ET_CR_Ma_old, ET_Penman1948 = ET_PM,
ET_CR_Ma_hydroTools, ET_CR_Xiao) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>% select(date, ET_CR_Ma,
# ET_CR_Ma_hydroTools,
ET_CR_Xiao, ET_PM) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
# debug 2022-07-02
d %>%
filter(ET_CR_Ma_old <= 20, ET_CR_Ma_old >= 0,
ET_CR_Ma_hydroTools <= 20, ET_CR_Ma_hydroTools >= 0) %>%
select(date, ET_CR_Ma, ET_CR_Ma_old, ET_Penman1948 = ET_PM,
ET_CR_Ma_hydroTools, ET_CR_Xiao) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
d %>% summary()
devtools::load_all(".")
library(data.table)
library(tidyverse)
devtools::load_all('../../hydroTools/')
d <- fread('inst/extdata/raw/54511.csv')
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_Ma_old = ET_CR_Ma_old(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_Ma = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
ET_CR_Ma_hydroTools = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_CR_Xiao = ET_CR_Xiao2020(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a,
ET_PM = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa))
# debug 2022-07-02
d %>%
filter(ET_CR_Ma_old <= 50, ET_CR_Ma_old >= 0,
ET_CR_Ma_hydroTools <= 50, ET_CR_Ma_hydroTools >= 0) %>%
select(date, ET_CR_Ma, ET_CR_Ma_old, ET_Penman1948 = ET_PM,
ET_CR_Ma_hydroTools, ET_CR_Xiao) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
# debug 2022-07-02
d %>%
filter(ET_CR_Ma_old <= 100, ET_CR_Ma_old >= 0,
ET_CR_Ma_hydroTools <= 100, ET_CR_Ma_hydroTools >= 0) %>%
select(date, ET_CR_Ma, ET_CR_Ma_old, ET_Penman1948 = ET_PM,
ET_CR_Ma_hydroTools, ET_CR_Xiao) %>%
pivot_longer(-date, names_to = 'type', values_to = 'ET') %>%
group_by(year = year(date), type) %>%
summarise(ET_yearly = sum(ET)) %>%
ggplot(aes(x = year, y = ET_yearly, color = type)) +
geom_line()
devtools::load_all(".")
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::load_all(".")
ET_summary(20, 50, 3, 0.5)
devtools::document()
devtools::check()
