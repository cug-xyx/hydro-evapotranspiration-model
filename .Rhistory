scale_shape_manual(values = c(19, 1)) +
theme(
text = element_text(family = 'serif', face = 'bold'),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
ggsci::scale_color_npg() +
labs(
title = 'site 50136'
)
library(foreach)
sts_id <- c('50136', '50137', '54511', '59287')
ggsave('C:/Users/kong/desktop/a.jpg', dpi = 400, height = 10, width = 12)
d <- fread('H:/data for cal_PET/SITES_CFSV2/54511.csv')
d %<>%
mutate(
VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a
)
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
scale_shape_manual(values = c(19, 1)) +
theme(
text = element_text(family = 'serif', face = 'bold'),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
ggsci::scale_color_npg()
d <- fread('H:/data for cal_PET/SITES_CFSV2/59287.csv')
d %<>%
mutate(
VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a
)
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
scale_shape_manual(values = c(19, 1)) +
theme(
text = element_text(family = 'serif', face = 'bold'),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
ggsci::scale_color_npg()
d <- fread('H:/data for cal_PET/SITES_CFSV2/50137.csv')
d %<>%
mutate(
VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a
)
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
scale_shape_manual(values = c(19, 1)) +
theme(
text = element_text(family = 'serif', face = 'bold'),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
ggsci::scale_color_npg()
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
scale_shape_manual(values = c(19, 1)) +
theme(
text = element_text(family = 'serif', face = 'bold'),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
ggsci::scale_color_npg()
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
scale_shape_manual(values = c(19, 1)) +
theme(
text = element_text(family = 'serif', face = 'bold'),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
ggsci::scale_color_npg()
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = ET_CR)) +
geom_point()
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50, ET_CR >= -10) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = ET_CR)) +
geom_point()
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50, ET_CR >= -10) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = ET_CR)) +
geom_point(aes(color = TAG))
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50, ET_CR >= -10) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = VPD)) +
geom_point(aes(color = ET_CR))
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50, ET_CR >= -10) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = ET_CR)) +
geom_point(aes(color = TAG))
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50, ET_CR >= -10) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = ET_CR)) +
geom_point(aes(color = TAG, size = Tavg))
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50, ET_CR >= -10) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = ET_CR)) +
geom_point(aes(color = TAG, size = U2))
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50, ET_CR >= -10) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = ET_CR)) +
geom_point(aes(color = TAG))
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50) %>%                                          # 筛选处理
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
scale_shape_manual(values = c(19, 1)) +
theme(
text = element_text(family = 'serif', face = 'bold'),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
ggsci::scale_color_npg()
d <- fread('H:/data for cal_PET/SITES_CFSV2/59287.csv')
d %<>%
mutate(
VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a
)
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50) %>%                                          # 筛选处理
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
scale_shape_manual(values = c(19, 1)) +
theme(
text = element_text(family = 'serif', face = 'bold'),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
ggsci::scale_color_npg()
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50, ET_CR >= -10) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = ET_CR)) +
geom_point(aes(color = TAG))
d <- fread('H:/data for cal_PET/SITES_CFSV2/59287.csv')
d %<>%
mutate(
VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
# ET_CR = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a
ET_CR = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa)
)
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50) %>%                                          # 筛选处理
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
scale_shape_manual(values = c(19, 1)) +
theme(
text = element_text(family = 'serif', face = 'bold'),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
ggsci::scale_color_npg()
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50, ET_CR >= -10) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = ET_CR)) +
geom_point(aes(color = TAG))
d <- fread('H:/data for cal_PET/SITES_CFSV2/50137.csv')
d %<>%
mutate(
VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
# ET_CR = ET_CR_Ma2021(Rn = Rn, Tair = Tavg, D = VPD, U2 = U2, Pa = Pa)$ET_a
ET_CR = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa)
)
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50) %>%                                          # 筛选处理
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
scale_shape_manual(values = c(19, 1)) +
theme(
text = element_text(family = 'serif', face = 'bold'),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
) +
ggsci::scale_color_npg()
d %>%
mutate(yr = year(date),
# RN_TAG = ifelse(Rn >= 0, 'Rn>0', 'Rn<0'),
# VPD_TAG = ifelse(VPD >= 0, 'VPD>0', 'VPD<0'),
TAG = case_when(Rn >= 0 & VPD >= 0 ~ 'Rn, VPD >= 0',
Rn <  0 & VPD >= 0 ~ 'Rn < 0',
Rn >= 0 & VPD <  0 ~ 'VPD < 0',
Rn <  0 & VPD <  0 ~ 'Rn, VPD < 0')) %>%
filter(ET_CR <= 50, ET_CR >= -10) %>%                                          # 筛选处理
ggplot(aes(x = Rn, y = ET_CR)) +
geom_point(aes(color = TAG))
# 检查Rn的异常导致了哪个参数产生异常，最终导致结果异常
d <- fread('H:/data for cal_PET/SITES_CFSV2/50137.csv')
d
?ET_CR_Ma
ET_CR_Ma
d %>% colnames()
d %>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
Twb = cal_Twb(VPD = VPD, Ta = avg, Pa = Pa),
Tdry = cal_Tdry(Twb = Twb, Pa = Pa, Ta = Ta),
Tw = cal_Tws(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
Epmax = ET_Penman1948_max(Tdry = Tdry, Rn = Rn, U2 = U2, Pa = Pa, Ta = Tavg),
Ep = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
Ew = ET_PT1972(Tw = Tw, Rn = Rn, Pa = Pa, Ta = Tavg),
ET_CR = ET_CR_Ma(Ta = Ta, Rn = Rn, U2 = U2, VPD = VPD , Pa = Pa))
d %>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
Twb = cal_Twb(VPD = VPD, Ta = Tavg, Pa = Pa),
Tdry = cal_Tdry(Twb = Twb, Pa = Pa, Ta = Ta),
Tw = cal_Tws(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
Epmax = ET_Penman1948_max(Tdry = Tdry, Rn = Rn, U2 = U2, Pa = Pa, Ta = Tavg),
Ep = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
Ew = ET_PT1972(Tw = Tw, Rn = Rn, Pa = Pa, Ta = Tavg),
ET_CR = ET_CR_Ma(Ta = Ta, Rn = Rn, U2 = U2, VPD = VPD , Pa = Pa))
d %>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
Twb = cal_Twb(VPD = VPD, Ta = Tavg, Pa = Pa),
Tdry = cal_Tdry(Twb = Twb, Pa = Pa, Ta = Tavg),
Tw = cal_Tws(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
Epmax = ET_Penman1948_max(Tdry = Tdry, Rn = Rn, U2 = U2, Pa = Pa, Ta = Tavg),
Ep = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
Ew = ET_PT1972(Tw = Tw, Rn = Rn, Pa = Pa, Ta = Tavg),
ET_CR = ET_CR_Ma(Ta = Ta, Rn = Rn, U2 = U2, VPD = VPD , Pa = Pa))
d %>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
Twb = cal_Twb(VPD = VPD, Ta = Tavg, Pa = Pa),
Tdry = cal_Tdry(Twb = Twb, Pa = Pa, Ta = Tavg),
Tw = cal_Tws(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
Epmax = ET_Penman1948_max(Tdry = Tdry, Rn = Rn, U2 = U2, Pa = Pa, Ta = Tavg),
Ep = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
Ew = ET_PT1972(Tw = Tw, Rn = Rn, Pa = Pa, Ta = Tavg),
ET_CR = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD , Pa = Pa))
d %<>%
mutate(VPD = hydroET::cal_VPD(Ta = Tavg, Pa = Pa, q = q),
Twb = cal_Twb(VPD = VPD, Ta = Tavg, Pa = Pa),
Tdry = cal_Tdry(Twb = Twb, Pa = Pa, Ta = Tavg),
Tw = cal_Tws(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
Epmax = ET_Penman1948_max(Tdry = Tdry, Rn = Rn, U2 = U2, Pa = Pa, Ta = Tavg),
Ep = ET_Penman1948(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa),
Ew = ET_PT1972(Tw = Tw, Rn = Rn, Pa = Pa, Ta = Tavg),
ET_CR = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD , Pa = Pa),
TAG = ifelse(Rn >= 0, 'Rn>=0', 'Rn<0'))
d
d %>%
mutate(yr = year(date))
d %>%
mutate(yr = year(date)) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_point() +
facet_wrap(~yr)
d %>%
mutate(yr = year(date)) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free')
d %>%
mutate(yr = year(date)) %>%
filter(ET_CR >= 50) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free')
d %>%
mutate(yr = year(date)) %>%
filter(ET_CR < 50) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free')
d %>%
mutate(yr = year(date)) %>%
filter(ET_CR < 50) %>%
ggplot(aes(x = date, y = ET_CR)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
theme(
legend.position = 'top',
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
d
d %>%
mutate(yr = year(date)) %>%
filter(ET_CR < 50) %>%
ggplot(aes(x = date, y = Twb)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
theme(
legend.position = 'top',
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
d %>%
mutate(yr = year(date)) %>%
filter(ET_CR < 50) %>%
ggplot(aes(x = date, y = Tdry)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
theme(
legend.position = 'top',
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
d %>%
mutate(yr = year(date)) %>%
filter(ET_CR < 50) %>%
ggplot(aes(x = date, y = Tw)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
theme(
legend.position = 'top',
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
d %>%
mutate(yr = year(date)) %>%
filter(ET_CR < 50) %>%
ggplot(aes(x = date, y = Epmax)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
theme(
legend.position = 'top',
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
d %>%
mutate(yr = year(date)) %>%
filter(ET_CR < 50) %>%
ggplot(aes(x = date, y = Ep)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
theme(
legend.position = 'top',
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
d %>%
mutate(yr = year(date)) %>%
filter(ET_CR < 50) %>%
ggplot(aes(x = date, y = Ew)) +
geom_point(aes(color = TAG)) +
facet_wrap(~yr, scales = 'free') +
theme(
legend.position = 'top',
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
1
1
fread('H:/data for cal_PET/SITES_CFSV2/59287.csv')
library(tidyverse)
library(tidyfst)
fread('H:/data for cal_PET/SITES_CFSV2/59287.csv')
fread('H:/data for cal_PET/SITES_CFSV2/59287.csv') %>%
mutate(VPD = cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_hydroET = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa)) %>%
summary()
devtools::load_all(".")
fread('H:/data for cal_PET/SITES_CFSV2/59287.csv') %>%
mutate(VPD = cal_VPD(Ta = Tavg, Pa = Pa, q = q),
ET_CR_hydroET = ET_CR_Ma(Ta = Tavg, Rn = Rn, U2 = U2, VPD = VPD, Pa = Pa)) %>%
summary()
